<h1 id="install">Install</h1>

<ol>
  <li>Über <code class="language-plaintext highlighter-rouge">apt install</code> installieren (wie <a href="https://docs.ros.org/en/galactic/Installation/Ubuntu-Install-Debians.html">hier</a> beschrieben)</li>
  <li>Dann, wie in <a href="https://docs.ros.org/en/galactic/Installation/Ubuntu-Install-Binary.html">binary installation</a> unter
    <ul>
      <li>“Installing and initializing rosdep” und</li>
      <li>“Installing the missing dependencies”</li>
    </ul>
  </li>
</ol>

<p>beschrieben, die restlichen dependencies installieren (ohne 2. funktioniert ROS2 nicht!).</p>

<h1 id="create-package">Create Package</h1>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">mkdir</span> <span class="nt">-p</span> ~/dev_ws/src
<span class="nv">$ </span><span class="nb">cd</span> ~/dev_ws/src
<span class="nv">$ </span><span class="nb">source</span> /opt/ros/eloquent/setup.bash
<span class="nv">$ </span>ros2 pkg create <span class="nt">--build-type</span> ament_cmake <span class="nt">--node-name</span> my_node my_package
</code></pre></div></div>

<h2 id="packagexml">package.xml</h2>

<ul>
  <li>make sure to fill in the <code class="language-plaintext highlighter-rouge">&lt;description&gt;</code>, <code class="language-plaintext highlighter-rouge">&lt;maintainer&gt;</code> and <code class="language-plaintext highlighter-rouge">&lt;license&gt;</code> tags in package.xml</li>
  <li>Add a new line after the <code class="language-plaintext highlighter-rouge">ament_cmake</code> buildtool dependency and paste the following dependencies corresponding to your node’s include statements:</li>
</ul>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;depend&gt;</span>rclcpp<span class="nt">&lt;/depend&gt;</span>
<span class="nt">&lt;depend&gt;</span>std_msgs<span class="nt">&lt;/depend&gt;</span>
</code></pre></div></div>

<h2 id="cmakeliststxt">CMakeLists.txt</h2>

<div class="language-cmake highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Now open the CMakeLists.txt file. Below the existing dependency find_package(ament_cmake REQUIRED), add the lines:</span>

<span class="nb">find_package</span><span class="p">(</span>rclcpp REQUIRED<span class="p">)</span>
<span class="nb">find_package</span><span class="p">(</span>std_msgs REQUIRED<span class="p">)</span>

<span class="c1"># After that, add the executable and name it talker so you can run your node using ros2 run:</span>

<span class="nb">add_executable</span><span class="p">(</span>talker src/publisher_member_function.cpp<span class="p">)</span>
<span class="nf">ament_target_dependencies</span><span class="p">(</span>talker rclcpp std_msgs<span class="p">)</span>

<span class="c1"># Finally, add the install(TARGETS…) section so ros2 run can find your executable:</span>

<span class="nb">install</span><span class="p">(</span>TARGETS
  talker
  DESTINATION lib/<span class="si">${</span><span class="nv">PROJECT_NAME</span><span class="si">}</span><span class="p">)</span>
</code></pre></div></div>

<h2 id="adding-a-node-to-cmakeliststxt">Adding a node to CMakeLists.txt</h2>

<p>E.g. in order to add the node <code class="language-plaintext highlighter-rouge">listener</code> write:</p>

<div class="language-cmake highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">add_executable</span><span class="p">(</span>listener src/subscriber_member_function.cpp<span class="p">)</span>
<span class="nf">ament_target_dependencies</span><span class="p">(</span>listener rclcpp std_msgs<span class="p">)</span>

<span class="nb">install</span><span class="p">(</span>TARGETS
  talker
  listener
  DESTINATION lib/<span class="si">${</span><span class="nv">PROJECT_NAME</span><span class="si">}</span><span class="p">)</span>
</code></pre></div></div>

<h2 id="build">Build</h2>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>rosdep <span class="nb">install</span> <span class="nt">-i</span> <span class="nt">--from-path</span> src <span class="nt">--rosdistro</span> eloquent <span class="nt">-y</span>
<span class="c"># check output of resdep install: "#All required rosdeps installed successfully"</span>
<span class="c"># in root of ws, here: "dev_ws": </span>
<span class="nv">$ </span><span class="nb">cd</span> ~/dev_ws
<span class="nv">$ </span>colcon build <span class="nt">--packages-select</span> my_package
</code></pre></div></div>

<h2 id="run">Run</h2>

<blockquote>
  <p><strong>Important</strong>: open a new terminal, separate from the one where you built the workspace (for <strong>both</strong>, underlay and overlay) !</p>
</blockquote>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># source underlay: </span>
<span class="nv">$ </span><span class="nb">source</span> /opt/ros/eloquent/setup.bash
<span class="nv">$ </span><span class="nb">cd</span> ~/dev_ws
<span class="c"># source overlay: </span>
<span class="nv">$ </span><span class="nb">.</span> <span class="nb">install</span>/local_setup.bash
</code></pre></div></div>

<blockquote>
  <p>Note: sourcing your main ROS 2 installation’s <code class="language-plaintext highlighter-rouge">setup</code> and then the <code class="language-plaintext highlighter-rouge">dev_ws</code> overlay’s <code class="language-plaintext highlighter-rouge">local_setup</code>, is the same as just sourcing <code class="language-plaintext highlighter-rouge">dev_ws</code>’s <code class="language-plaintext highlighter-rouge">setup</code>, because that includes the environment of the underlay it was created in.</p>
</blockquote>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>ros2 run turtlesim turtlesim_node
</code></pre></div></div>

<h1 id="rosdep">rosdep</h1>

<p>Packages declare their dependencies in the <strong>package.xml</strong> file. This command walks through those declarations and installs the ones that are missing.</p>

<h1 id="colcon">colcon</h1>

<h2 id="build-1">build</h2>

<h3 id="arguments">arguments</h3>

<ul>
  <li><code class="language-plaintext highlighter-rouge">--packages-up-to</code> builds the package you want, plus all its dependencies, but not the whole workspace (saves time)</li>
  <li><code class="language-plaintext highlighter-rouge">--symlink-install</code> saves you from having to rebuild every time you tweak python scripts</li>
  <li><code class="language-plaintext highlighter-rouge">--event-handlers console_direct+</code> shows console output while building (can otherwise be found in the log directory)</li>
</ul>

<h1 id="ros2-pkg">ros2 pkg</h1>

<h2 id="create">create</h2>

<h3 id="arguments-1">arguments</h3>

<ul>
  <li><code class="language-plaintext highlighter-rouge">--build-type</code>: <code class="language-plaintext highlighter-rouge">ament_cmake</code></li>
  <li><code class="language-plaintext highlighter-rouge">--dependencies</code> will automatically add the necessary dependency lines to <code class="language-plaintext highlighter-rouge">package.xml</code> and <code class="language-plaintext highlighter-rouge">CMakeLists.txt</code></li>
</ul>

<h1 id="publisher-subscriber">Publisher-Subscriber</h1>

<h2 id="queue-size">Queue Size</h2>

<p>from: <a href="https://stackoverflow.com/a/60554760/12282296">source</a></p>

<p>A real life example can be a scenario of a waiter and a kitchen to wash dishes. Suppose the costumers ends its meals and the waiter takes their dirty dishes to wash in the kitchen. He puts in a table. Whenever the dishwasher can, he goes to table and gets dishes and take to wash. In normal operation the table is never filled. But if someone else give another task to the dishwasher guy, the table will start to get full. Until some time the waiter can’t place dishes anymore and leave tables dirty (problem in the system). But if table is artificially large there (let’s say 1000 square units) the waiter will likely fulfill its job even if dishwasher is busy, considering that after some time he will be able to return to clean dishes.</p>

<h1 id="gazebo">Gazebo</h1>

<h2 id="reopen-the-gui-window">reopen the GUI window</h2>

<p>from: <a href="https://answers.gazebosim.org/question/541/what-is-a-simple-way-to-run-gazebo-with-no-graphics/?answer=544#post-id-544">source</a></p>

<blockquote>
  <p>When you launch gazebo, there are two programs that are run: gzserver and gzclient. The program gzserver does all the simulation, even rendering for camera simulation. The interactive window is opened by gzclient.
To open a specific world, type gzserver specific.world.</p>
</blockquote>

<p>I.e. simply reopen the GUI by entering the command <code class="language-plaintext highlighter-rouge">gzclient</code>.</p>

<h2 id="adding-models">adding models</h2>

<ul>
  <li><code class="language-plaintext highlighter-rouge">wget -q -R *index.html*,*.tar.gz --no-parent -r -x -nH http://models.gazebosim.org/cardboard_box/</code> download model cardboard_box</li>
</ul>

<h2 id="xacro-macros-xacro">Xacro Macros (.xacro)</h2>

<ul>
  <li>s. <a href="http://wiki.ros.org/xacro#Macros">http://wiki.ros.org/xacro#Macros</a></li>
  <li>nicht vergessen: <code class="language-plaintext highlighter-rouge">*origin</code> in <code class="language-plaintext highlighter-rouge">param="suffix *origin"</code> ist <strong>kein</strong> Parameter und muss ein separates Element sein (s. <a href="http://wiki.ros.org/xacro#Macros">Link</a> oben)!</li>
</ul>

<h2 id="components-of-sdf-models">Components of SDF Models</h2>

<p>Source: <a href="http://gazebosim.org/tutorials?tut=build_model">http://gazebosim.org/tutorials?tut=build_model</a></p>

<blockquote>
<p><strong>Links:</strong> A link contains the physical properties of one body of the model. This can be a wheel, or a link in a joint chain. Each link may contain many collision and visual elements. Try to reduce the number of links in your models in order to improve performance and stability. For example, a table model could consist of 5 links (4 for the legs and 1 for the top) connected via joints. However, this is overly complex, especially since the joints will never move. Instead, create the table with 1 link and 5 collision elements.</p>

<blockquote>
<p><strong>Collision:</strong> A collision element encapsulates a geometry that is used for collision checking. This can be a simple shape (which is preferred), or a triangle mesh (which consumes greater resources). A link may contain many collision elements.</p>

<p><strong>Visual:</strong> A visual element is used to visualize parts of a link. A link may contain 0 or more visual elements.</p>

<p><strong>Inertial:</strong> The inertial element describes the dynamic properties of the link, such as mass and rotational inertia matrix.</p>

<p><strong>Sensor:</strong> A sensor collects data from the world for use in plugins. A link may contain 0 or more sensors.</p>

<p><strong>Light:</strong> A light element describes a light source attached to a link. A link may contain 0 or more lights.</p>
</blockquote>

<p><strong>Joints:</strong> A joint connects two links. A parent and child relationship is established along with other parameters such as axis of rotation, and joint limits.</p>

<p><strong>Plugins:</strong> A plugin is a shared library created by a third party to control a model.</p>
</blockquote>

<h1 id="troubleshooting">Troubleshooting</h1>

<ul>
  <li><code class="language-plaintext highlighter-rouge">rosnode kill -a; killall -9 rosmaster; killall -9 roscore</code>, if nodes do not stop automatically</li>
</ul>

<h2 id="fiese-fehler">Fiese Fehler</h2>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/usr/lib/gcc/x86_64-linux-gnu/7/../../../x86_64-linux-gnu/Scrt1.o: In <span class="k">function</span> <span class="sb">`</span>_start<span class="s1">':
(.text+0x20): undefined reference to `main'</span>
collect2: error: ld returned 1 <span class="nb">exit </span>status
make[2]: <span class="k">***</span> <span class="o">[</span>HoughLinesNode] Error 1
make[1]: <span class="k">***</span> <span class="o">[</span>CMakeFiles/HoughLinesNode.dir/all] Error 2
make: <span class="k">***</span> <span class="o">[</span>all] Error 2
<span class="nt">---</span>
Failed   <span class="o">&lt;&lt;&lt;</span> galaxis_HoughLines_pkg <span class="o">[</span>12.8s, exited with code 2]
</code></pre></div></div>

<ul>
  <li>this simply means you forgot to write a <code class="language-plaintext highlighter-rouge">main.cpp</code> or a <code class="language-plaintext highlighter-rouge">main()</code> function for your ROS node</li>
</ul>
